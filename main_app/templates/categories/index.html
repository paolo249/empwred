{% extends 'base.html' %}
{% block content %}

<h1> Your Dashboard </h1>

<section id="daily-quote">
    {{ html|safe }}
</section>

<a href="{% url 'activity_create' %}">Add Activity</a>
<a href="{% url 'activity_list' %}">All Activites</a>

<div id ="dashboard">
    <div id="radar" style="width: 75%;">
        <canvas id="radar-chart"></canvas>
    </div>


    <div class="circle-wrapper">
    {% for c in categories %}
    <a class ="circle {{ c.title }} btn-floating btn-large pulse category" href="{% url 'activity_list' %}?category={{c.title}}">
        <div>
            {{ c.title }}
        </div>
    </a>
    {% endfor %}
    </div>
</div>

<script>
    const CATEGORIES = [
        {% for c in categories %}
            '{{ c.title }}',
        {% endfor %}
    ]

    const totals = {{ totals|safe }}
    CATEGORIES.forEach(c => {
        if (!totals.some(tot => tot.title === c)) totals.push({'title': c, 'mins': 0}) 
    })
    totals.sort((a, b) => a.title > b.title ? 1 : -1)
    
    const labels = totals.map(tot => tot.title)
    const mins = totals.map(tot => tot.mins)

    const data = {
        labels: labels,
        datasets: [{
            label: 'Past week',
            data: mins,
            fill: true,
            backgroundColor: 'rgba(255, 99, 132, 0.2)',
            borderColor: 'rgb(255, 99, 132)',
            pointBackgroundColor: 'rgb(255, 99, 132)',
            pointBorderColor: '#fff',
            pointHoverBackgroundColor: '#fff',
            pointHoverBorderColor: 'rgb(255, 99, 132)'
        }]
    };

    const config = {
        type: 'radar',
        data: data,
        options: {
            responsive: true,
            elements: {
                line: {
                    borderWidth: 3
                }
            }
        },
    };

    window.onload = function() {
      var ctx = document.getElementById('radar-chart').getContext('2d');
      window.myRadar = new Chart(ctx, config);
    };
</script>

{% endblock %}